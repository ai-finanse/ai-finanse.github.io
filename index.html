<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>AI FINANSE</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:ital,opsz,wght@0,9..40,300;0,9..40,400;0,9..40,500;0,9..40,600;0,9..40,700&family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --brand: #0066FF;
            --brand-dark: #0052CC;
            --brand-light: #E6F0FF;
            --green: #00C48C;
            --green-bg: #E6FAF3;
            --red: #FF4757;
            --red-bg: #FFE8EB;
            --orange: #FF9F43;
            --orange-bg: #FFF4E6;
            --bg: #F0F2F5;
            --card: #FFFFFF;
            --text: #1A1D21;
            --text2: #6B7280;
            --text3: #9CA3AF;
            --border: #E5E7EB;
            --input-bg: #F9FAFB;
            --shadow: 0 1px 3px rgba(0,0,0,0.06), 0 1px 2px rgba(0,0,0,0.04);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.08);
            --radius: 14px;
            --radius-sm: 10px;
        }

        body {
            font-family: 'DM Sans', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg);
            color: var(--text);
            overflow-x: hidden;
            -webkit-font-smoothing: antialiased;
        }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê HEADER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .header {
            background: var(--brand);
            padding: 18px 20px;
            text-align: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .header-logo {
            font-family: 'JetBrains Mono', monospace;
            font-size: 20px;
            font-weight: 700;
            color: #fff;
            letter-spacing: 1.5px;
        }
        .header-logo span { 
            color: rgba(255,255,255,0.5); 
            font-weight: 400; 
        }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CONTAINER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .container { padding: 16px; max-width: 480px; margin: 0 auto; }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SCREENS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .screen { display: none; }
        .screen.active { display: block; animation: slideIn 0.25s ease-out; }
        @keyframes slideIn {
            from { opacity: 0; transform: translateY(8px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CARD ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .card {
            background: var(--card);
            border-radius: var(--radius);
            padding: 20px;
            margin-bottom: 12px;
            box-shadow: var(--shadow);
        }
        .card-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--text2);
            text-transform: uppercase;
            letter-spacing: 0.8px;
            margin-bottom: 16px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .card-title .icon { font-size: 18px; }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INPUTS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .form-group { margin-bottom: 14px; }
        .form-label {
            display: block;
            font-size: 13px;
            font-weight: 500;
            color: var(--text2);
            margin-bottom: 6px;
        }
        .form-input {
            width: 100%;
            padding: 14px 16px;
            border: 1.5px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 16px;
            font-family: inherit;
            background: var(--input-bg);
            color: var(--text);
            transition: border-color 0.2s, box-shadow 0.2s;
            -webkit-appearance: none;
        }
        .form-input:focus {
            outline: none;
            border-color: var(--brand);
            box-shadow: 0 0 0 3px rgba(0,102,255,0.12);
            background: #fff;
        }
        .form-input::placeholder { color: var(--text3); }
        .form-input.error { border-color: var(--red); }

        select.form-input {
            cursor: pointer;
            background-image: url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1.5L6 6.5L11 1.5' stroke='%236B7280' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 14px center;
            padding-right: 40px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CODE INPUT (Page 1) ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .code-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 40px 20px;
        }
        .code-icon { font-size: 56px; margin-bottom: 20px; }
        .code-title {
            font-size: 22px;
            font-weight: 700;
            margin-bottom: 8px;
        }
        .code-subtitle {
            font-size: 14px;
            color: var(--text2);
            margin-bottom: 32px;
        }
        .code-inputs {
            display: flex;
            gap: 8px;
            margin-bottom: 24px;
        }
        .code-digit {
            width: 48px;
            height: 56px;
            border: 2px solid var(--border);
            border-radius: var(--radius-sm);
            text-align: center;
            font-size: 24px;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
            background: var(--input-bg);
            color: var(--text);
            transition: all 0.2s;
            -webkit-appearance: none;
        }
        .code-digit:focus {
            outline: none;
            border-color: var(--brand);
            box-shadow: 0 0 0 3px rgba(0,102,255,0.15);
            background: #fff;
        }
        .code-digit.filled { border-color: var(--brand); background: var(--brand-light); }
        .code-digit.error-shake {
            border-color: var(--red);
            animation: shake 0.4s ease;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-6px); }
            75% { transform: translateX(6px); }
        }
        .forgot-link {
            font-size: 14px;
            color: var(--brand);
            cursor: pointer;
            font-weight: 500;
            border: none;
            background: none;
            padding: 8px;
        }
        .forgot-link:active { opacity: 0.7; }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BUTTONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 100%;
            padding: 16px;
            border: none;
            border-radius: var(--radius-sm);
            font-size: 15px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: all 0.15s;
            -webkit-tap-highlight-color: transparent;
        }
        .btn:active { transform: scale(0.98); }
        .btn-primary { background: var(--brand); color: #fff; }
        .btn-primary:hover { background: var(--brand-dark); }
        .btn-primary:disabled { background: #B0C4DE; cursor: not-allowed; transform: none; }
        .btn-secondary { background: var(--input-bg); color: var(--text); border: 1.5px solid var(--border); }
        .btn-secondary:hover { background: var(--border); }
        .btn-green { background: var(--green); color: #fff; }
        .btn-green:hover { background: #00A87A; }
        .btn-outline { background: transparent; color: var(--brand); border: 1.5px solid var(--brand); }
        .btn-outline:hover { background: var(--brand-light); }
        .btn .btn-icon { font-size: 18px; }
        .btn + .btn { margin-top: 10px; }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DASHBOARD STATS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .stats-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 4px;
        }
        .stat-box {
            background: var(--input-bg);
            border-radius: var(--radius-sm);
            padding: 16px 14px;
            text-align: center;
            border: 1px solid var(--border);
        }
        .stat-label {
            font-size: 11px;
            font-weight: 600;
            color: var(--text3);
            text-transform: uppercase;
            letter-spacing: 0.6px;
            margin-bottom: 8px;
        }
        .stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 20px;
            font-weight: 700;
        }
        .stat-value.blue { color: var(--brand); }
        .stat-value.green { color: var(--green); }
        .stat-value.red { color: var(--red); }
        .stat-value.orange { color: var(--orange); }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê MENU BUTTONS ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .menu-grid {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        .menu-btn {
            display: flex;
            align-items: center;
            gap: 14px;
            padding: 16px;
            background: var(--card);
            border: 1.5px solid var(--border);
            border-radius: var(--radius-sm);
            cursor: pointer;
            transition: all 0.15s;
            -webkit-tap-highlight-color: transparent;
        }
        .menu-btn:active { transform: scale(0.98); background: var(--input-bg); }
        .menu-btn .m-icon {
            width: 42px;
            height: 42px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 20px;
            flex-shrink: 0;
        }
        .menu-btn .m-icon.blue { background: var(--brand-light); }
        .menu-btn .m-icon.green { background: var(--green-bg); }
        .menu-btn .m-icon.orange { background: var(--orange-bg); }
        .menu-btn .m-text { flex: 1; }
        .menu-btn .m-title { font-size: 15px; font-weight: 600; }
        .menu-btn .m-desc { font-size: 12px; color: var(--text2); margin-top: 2px; }
        .menu-btn .m-arrow { color: var(--text3); font-size: 18px; }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê UPLOAD AREA ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .upload-zone {
            border: 2px dashed var(--border);
            border-radius: var(--radius);
            padding: 32px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
            margin-bottom: 16px;
        }
        .upload-zone:active { border-color: var(--brand); background: var(--brand-light); }
        .upload-zone .uz-icon { font-size: 40px; margin-bottom: 10px; }
        .upload-zone .uz-text { font-size: 15px; font-weight: 500; color: var(--text2); }
        .upload-zone .uz-hint { font-size: 12px; color: var(--text3); margin-top: 6px; }

        .upload-actions {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 8px;
            margin-bottom: 20px;
        }
        .upload-action-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 6px;
            padding: 14px 8px;
            background: var(--input-bg);
            border: 1.5px solid var(--border);
            border-radius: var(--radius-sm);
            cursor: pointer;
            font-family: inherit;
            font-size: 12px;
            font-weight: 500;
            color: var(--text2);
            transition: all 0.15s;
        }
        .upload-action-btn:active { background: var(--brand-light); border-color: var(--brand); }
        .upload-action-btn .ua-icon { font-size: 24px; }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DOC LIST ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .doc-item {
            display: flex;
            align-items: center;
            gap: 12px;
            padding: 12px;
            background: var(--input-bg);
            border-radius: var(--radius-sm);
            margin-bottom: 6px;
        }
        .doc-item .di-icon { font-size: 22px; flex-shrink: 0; }
        .doc-item .di-name { font-size: 14px; font-weight: 500; }
        .doc-item .di-date { font-size: 11px; color: var(--text3); }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê CHAT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .chat-box {
            height: 380px;
            overflow-y: auto;
            padding: 14px;
            background: var(--bg);
            border-radius: var(--radius-sm);
            margin-bottom: 12px;
        }
        .msg {
            max-width: 80%;
            padding: 10px 14px;
            border-radius: 14px;
            margin-bottom: 8px;
            font-size: 14px;
            line-height: 1.45;
            word-wrap: break-word;
        }
        .msg.client {
            background: var(--brand);
            color: #fff;
            margin-left: auto;
            border-bottom-right-radius: 4px;
        }
        .msg.manager {
            background: var(--card);
            border: 1px solid var(--border);
            border-bottom-left-radius: 4px;
        }
        .msg-sender { font-size: 11px; font-weight: 600; margin-bottom: 3px; opacity: 0.75; }
        .msg-time { font-size: 10px; margin-top: 4px; opacity: 0.6; }
        .chat-input-row { display: flex; gap: 8px; }
        .chat-input-row textarea {
            flex: 1;
            padding: 12px 14px;
            border: 1.5px solid var(--border);
            border-radius: var(--radius-sm);
            font-size: 15px;
            font-family: inherit;
            resize: none;
            background: var(--input-bg);
        }
        .chat-input-row textarea:focus { outline: none; border-color: var(--brand); }
        .chat-send-btn {
            width: 48px;
            height: 48px;
            border-radius: var(--radius-sm);
            border: none;
            background: var(--brand);
            color: #fff;
            font-size: 20px;
            cursor: pointer;
            flex-shrink: 0;
        }
        .chat-send-btn:active { background: var(--brand-dark); }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INVOICE ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .toggle-row {
            display: flex;
            background: var(--input-bg);
            border-radius: var(--radius-sm);
            padding: 4px;
            margin-bottom: 16px;
            border: 1px solid var(--border);
        }
        .toggle-opt {
            flex: 1;
            padding: 10px;
            text-align: center;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            border: none;
            background: transparent;
            font-family: inherit;
            color: var(--text2);
        }
        .toggle-opt.active { background: var(--brand); color: #fff; box-shadow: var(--shadow); }

        .invoice-actions {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid var(--border);
        }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê ALERT ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .alert-toast {
            position: fixed;
            top: 70px;
            left: 50%;
            transform: translateX(-50%);
            padding: 12px 20px;
            border-radius: var(--radius-sm);
            font-size: 14px;
            font-weight: 500;
            z-index: 999;
            animation: toastIn 0.3s ease, toastOut 0.3s ease 2.7s forwards;
            max-width: 90%;
            text-align: center;
        }
        .alert-toast.success { background: var(--green); color: #fff; }
        .alert-toast.error { background: var(--red); color: #fff; }
        @keyframes toastIn { from { opacity: 0; transform: translateX(-50%) translateY(-10px); } to { opacity: 1; transform: translateX(-50%) translateY(0); } }
        @keyframes toastOut { from { opacity: 1; } to { opacity: 0; } }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê SPINNER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .spinner {
            width: 32px; height: 32px;
            border: 3px solid var(--border);
            border-top-color: var(--brand);
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
        .loading-state { text-align: center; padding: 40px 20px; color: var(--text2); }
        .loading-state p { margin-top: 12px; font-size: 14px; }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê DIVIDER ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .divider { height: 1px; background: var(--border); margin: 16px 0; }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê INFO ITEM ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .info-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 13px 0;
            border-bottom: 1px solid var(--border);
        }
        .info-row:last-child { border-bottom: none; }
        .info-row .ir-label { font-size: 14px; color: var(--text2); }
        .info-row .ir-value { font-size: 14px; font-weight: 600; }

        /* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê BACK BUTTON ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
        .back-row {
            margin-top: 8px;
        }
    </style>
</head>
<body>

<!-- HEADER -->
<div class="header">
    <div class="header-logo">AI <span>|</span> FINANSE</div>
</div>

<div class="container">

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- PAGE 1: LOGIN CODE                      -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-login" class="screen active">
        <div class="card">
            <div class="code-wrapper">
                <div class="code-icon">üîê</div>
                <div class="code-title">–í–≤–µ–¥–∏—Ç–µ –∫–æ–¥</div>
                <div class="code-subtitle">6-–∑–Ω–∞—á–Ω—ã–π –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞</div>
                <div class="code-inputs" id="codeInputs">
                    <input type="tel" maxlength="1" class="code-digit" data-idx="0" inputmode="numeric" autocomplete="off">
                    <input type="tel" maxlength="1" class="code-digit" data-idx="1" inputmode="numeric" autocomplete="off">
                    <input type="tel" maxlength="1" class="code-digit" data-idx="2" inputmode="numeric" autocomplete="off">
                    <input type="tel" maxlength="1" class="code-digit" data-idx="3" inputmode="numeric" autocomplete="off">
                    <input type="tel" maxlength="1" class="code-digit" data-idx="4" inputmode="numeric" autocomplete="off">
                    <input type="tel" maxlength="1" class="code-digit" data-idx="5" inputmode="numeric" autocomplete="off">
                </div>
                <button class="forgot-link" onclick="showScreen('page-forgot')">–ó–∞–±—ã–ª–∏ –∫–æ–¥?</button>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- PAGE 11: FORGOT CODE (NIP + PESEL)      -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-forgot" class="screen">
        <div class="card">
            <div class="card-title"><span class="icon">üîë</span> –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞</div>
            <div class="form-group">
                <label class="form-label">NIP –∫–æ–º–ø–∞–Ω–∏–∏</label>
                <input type="tel" class="form-input" id="forgotNip" placeholder="0000000000" maxlength="10" inputmode="numeric">
            </div>
            <div class="form-group">
                <label class="form-label">PESEL –≤–ª–∞–¥–µ–ª—å—Ü–∞</label>
                <input type="tel" class="form-input" id="forgotPesel" placeholder="00000000000" maxlength="11" inputmode="numeric">
            </div>
            <button class="btn btn-primary" onclick="verifyIdentity()">
                <span class="btn-icon">‚úì</span> –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å
            </button>
        </div>
        <div class="back-row">
            <button class="btn btn-secondary" onclick="showScreen('page-login')">
                <span class="btn-icon">‚Üê</span> –ù–∞–∑–∞–¥
            </button>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- PAGE 12: SET NEW CODE                   -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-newcode" class="screen">
        <div class="card">
            <div class="card-title"><span class="icon">üîí</span> –ù–æ–≤—ã–π –∫–æ–¥ –¥–æ—Å—Ç—É–ø–∞</div>
            <div class="form-group">
                <label class="form-label">–í–≤–µ–¥–∏—Ç–µ –Ω–æ–≤—ã–π –∫–æ–¥ (6 —Ü–∏—Ñ—Ä)</label>
                <input type="tel" class="form-input" id="newCode" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="6" inputmode="numeric" style="font-family: 'JetBrains Mono', monospace; letter-spacing: 8px; text-align: center; font-size: 24px;">
            </div>
            <div class="form-group">
                <label class="form-label">–ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –∫–æ–¥</label>
                <input type="tel" class="form-input" id="confirmCode" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="6" inputmode="numeric" style="font-family: 'JetBrains Mono', monospace; letter-spacing: 8px; text-align: center; font-size: 24px;">
            </div>
            <button class="btn btn-primary" onclick="saveNewCode()">
                <span class="btn-icon">üíæ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–¥
            </button>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- PAGE 2: COMPANY DATA                    -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-company" class="screen">
        <div class="card">
            <div class="card-title"><span class="icon">üè¢</span> –î–∞–Ω–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏</div>
            <div class="form-group">
                <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏</label>
                <input type="text" class="form-input" id="compName" placeholder="Nazwa firmy">
            </div>
            <div class="divider"></div>
            <div class="card-title" style="font-size:13px; margin-bottom:12px;"><span class="icon">üìç</span> –ê–¥—Ä–µ—Å</div>
            <div class="form-group">
                <label class="form-label">–£–ª–∏—Ü–∞</label>
                <input type="text" class="form-input" id="compStreet" placeholder="ul. Przyk≈Çadowa">
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">–î–æ–º / –û—Ñ–∏—Å</label>
                    <input type="text" class="form-input" id="compBuilding" placeholder="10/2">
                </div>
                <div class="form-group">
                    <label class="form-label">–ü–æ—á—Ç–æ–≤—ã–π –∫–æ–¥</label>
                    <input type="text" class="form-input" id="compZip" placeholder="00-000" maxlength="6">
                </div>
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">–ì–æ—Ä–æ–¥</label>
                    <input type="text" class="form-input" id="compCity" placeholder="Warszawa">
                </div>
                <div class="form-group">
                    <label class="form-label">–°—Ç—Ä–∞–Ω–∞</label>
                    <select class="form-input" id="compCountry">
                        <option value="PL">Polska</option>
                        <option value="DE">Niemcy</option>
                        <option value="AT">Austria</option>
                        <option value="CZ">Czechy</option>
                        <option value="UA">Ukraina</option>
                        <option value="OTHER">Inne</option>
                    </select>
                </div>
            </div>
            <div class="divider"></div>
            <div class="card-title" style="font-size:13px; margin-bottom:12px;"><span class="icon">üìã</span> –†–µ–∫–≤–∏–∑–∏—Ç—ã</div>
            <div class="form-group">
                <label class="form-label">NIP</label>
                <input type="tel" class="form-input" id="compNip" placeholder="0000000000" maxlength="10" inputmode="numeric">
            </div>
            <div class="form-group">
                <label class="form-label">IBAN (–Ω–æ–º–µ—Ä —Å—á—ë—Ç–∞)</label>
                <input type="text" class="form-input" id="compIban" placeholder="PL00 0000 0000 0000 0000 0000 0000">
            </div>
            <div class="form-group" id="swiftGroup" style="display:none;">
                <label class="form-label">SWIFT / BIC</label>
                <input type="text" class="form-input" id="compSwift" placeholder="BREXPLPW">
            </div>
            <div class="form-group">
                <label class="form-label">–û—Å–Ω–æ–≤–Ω–æ–π PKD</label>
                <input type="text" class="form-input" id="compPkd" placeholder="62.01.Z">
            </div>
        </div>
        <button class="btn btn-primary" onclick="saveCompanyData()">
            <span class="btn-icon">üíæ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
        </button>
        <button class="btn btn-secondary" onclick="showScreen('page-dashboard')" id="compBackBtn" style="display:none;">
            <span class="btn-icon">‚Üê</span> –ù–∞–∑–∞–¥
        </button>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- PAGE 3: DASHBOARD                       -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-dashboard" class="screen">
        <!-- Stats -->
        <div class="card">
            <div class="card-title"><span class="icon">üìä</span> –§–∏–Ω–∞–Ω—Å—ã</div>
            <div class="stats-grid">
                <div class="stat-box">
                    <div class="stat-label">–ü—Ä–∏—Ö–æ–¥</div>
                    <div class="stat-value green" id="dPrihod">‚Äî</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">–†–∞—Å—Ö–æ–¥</div>
                    <div class="stat-value red" id="dRashod">‚Äî</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">–î–æ—Ö–æ–¥</div>
                    <div class="stat-value blue" id="dDohod">‚Äî</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">–ù–î–° (VAT)</div>
                    <div class="stat-value orange" id="dVat">‚Äî</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">PIT</div>
                    <div class="stat-value blue" id="dPit">‚Äî</div>
                </div>
                <div class="stat-box">
                    <div class="stat-label">ZUS</div>
                    <div class="stat-value blue" id="dZus">‚Äî</div>
                </div>
            </div>
        </div>

        <!-- Menu -->
        <div class="menu-grid">
            <div class="menu-btn" onclick="showScreen('page-invoice')">
                <div class="m-icon green">üìù</div>
                <div class="m-text">
                    <div class="m-title">–í—ã–ø–∏—Å–∞—Ç—å —Å—á—ë—Ç</div>
                    <div class="m-desc">–§–∞–∫—Ç—É—Ä–∞ –∏–ª–∏ –ø—Ä–æ—Ñ–æ—Ä–º–∞</div>
                </div>
                <div class="m-arrow">‚Ä∫</div>
            </div>
            <div class="menu-btn" onclick="showScreen('page-upload')">
                <div class="m-icon blue">üì§</div>
                <div class="m-text">
                    <div class="m-title">–í—ã—Å–ª–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã</div>
                    <div class="m-desc">–§–æ—Ç–æ, —Å–∫–∞–Ω—ã, PDF</div>
                </div>
                <div class="m-arrow">‚Ä∫</div>
            </div>
            <div class="menu-btn" onclick="showScreen('page-chat')">
                <div class="m-icon orange">üí¨</div>
                <div class="m-text">
                    <div class="m-title">–ß–∞—Ç —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º</div>
                    <div class="m-desc">–°–≤—è–∑–∞—Ç—å—Å—è —Å –±—É—Ö–≥–∞–ª—Ç–µ—Ä–æ–º</div>
                </div>
                <div class="m-arrow">‚Ä∫</div>
            </div>
            <div class="menu-btn" onclick="showScreen('page-info')">
                <div class="m-icon blue">üìã</div>
                <div class="m-text">
                    <div class="m-title">–ü–æ–ª–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</div>
                    <div class="m-desc">–¢–∞—Ä–∏—Ñ, –¥–µ–∫–ª–∞—Ä–∞—Ü–∏–∏, —Ä–µ–∫–≤–∏–∑–∏—Ç—ã</div>
                </div>
                <div class="m-arrow">‚Ä∫</div>
            </div>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- PAGE 4: UPLOAD DOCUMENTS                -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-upload" class="screen">
        <div class="card">
            <div class="card-title"><span class="icon">üì§</span> –í—ã—Å–ª–∞—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç—ã</div>
            
            <input type="file" id="fileGallery" accept="image/*" style="display:none" multiple>
            <input type="file" id="fileCamera" accept="image/*" capture="environment" style="display:none">
            <input type="file" id="fileFiles" accept=".pdf,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx" style="display:none" multiple>

            <div class="upload-zone" onclick="document.getElementById('fileFiles').click()">
                <div class="uz-icon">üìÅ</div>
                <div class="uz-text">–ù–∞–∂–º–∏—Ç–µ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏</div>
                <div class="uz-hint">–§–æ—Ç–æ, —Å–∫–∞–Ω—ã, PDF ‚Äî –¥–æ 10 –ú–ë</div>
            </div>

            <div class="upload-actions">
                <button class="upload-action-btn" onclick="document.getElementById('fileGallery').click()">
                    <span class="ua-icon">üñº</span>
                    –ú–µ–¥–∏–∞—Ç–µ–∫–∞
                </button>
                <button class="upload-action-btn" onclick="document.getElementById('fileCamera').click()">
                    <span class="ua-icon">üì∑</span>
                    –°–Ω–∏–º–æ–∫
                </button>
                <button class="upload-action-btn" onclick="document.getElementById('fileFiles').click()">
                    <span class="ua-icon">üìé</span>
                    –§–∞–π–ª—ã
                </button>
            </div>

            <div id="uploadStatus"></div>
        </div>

        <div class="card">
            <div class="card-title"><span class="icon">üìã</span> –ü–æ—Å–ª–µ–¥–Ω–∏–µ –≤—ã—Å–ª–∞–Ω–Ω—ã–µ</div>
            <div id="recentDocs">
                <div class="loading-state">
                    <div class="spinner"></div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                </div>
            </div>
        </div>

        <div class="back-row">
            <button class="btn btn-secondary" onclick="showScreen('page-dashboard')">
                <span class="btn-icon">‚Üê</span> –í–µ—Ä–Ω—É—Ç—å—Å—è
            </button>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- PAGE 5: CHAT                            -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-chat" class="screen">
        <div class="card">
            <div class="card-title"><span class="icon">üí¨</span> –ß–∞—Ç —Å –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º</div>
            <div class="chat-box" id="chatMessages">
                <div class="loading-state">
                    <div class="spinner"></div>
                    <p>–ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π...</p>
                </div>
            </div>
            <div class="chat-input-row">
                <textarea id="chatInput" rows="2" placeholder="–ù–∞–ø–∏—à–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ..."></textarea>
                <button class="chat-send-btn" onclick="sendChatMessage()">‚û§</button>
            </div>
        </div>
        <div class="back-row">
            <button class="btn btn-secondary" onclick="showScreen('page-dashboard')">
                <span class="btn-icon">‚Üê</span> –í–µ—Ä–Ω—É—Ç—å—Å—è
            </button>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- PAGE 6: INVOICE                         -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-invoice" class="screen">
        <div class="card">
            <div class="card-title"><span class="icon">üìù</span> –°–æ–∑–¥–∞—Ç—å —Å—á—ë—Ç-—Ñ–∞–∫—Ç—É—Ä—É</div>

            <!-- Toggle: Proforma / Faktura -->
            <div class="toggle-row">
                <button class="toggle-opt active" onclick="setInvoiceType('proforma', this)">–ü—Ä–æ—Ñ–æ—Ä–º–∞</button>
                <button class="toggle-opt" onclick="setInvoiceType('faktura', this)">–§–∞–∫—Ç—É—Ä–∞</button>
            </div>

            <div class="form-group">
                <label class="form-label">–ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç (–Ω–∞–∑–≤–∞–Ω–∏–µ)</label>
                <input type="text" class="form-input" id="invContractor" placeholder="Nazwa kontrahenta">
            </div>
            <div class="form-group">
                <label class="form-label">NIP –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞</label>
                <div style="display:flex; gap:8px;">
                    <input type="tel" class="form-input" id="invNip" placeholder="0000000000" maxlength="10" inputmode="numeric" style="flex:1;">
                    <button class="btn btn-outline" style="width:auto; padding:14px 16px; margin:0;" onclick="lookupNip()">üîç</button>
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">–ù–æ–º–µ—Ä —Å—á—ë—Ç–∞</label>
                <input type="text" class="form-input" id="invNumber" placeholder="–ê–≤—Ç–æ" readonly style="background:#f0f2f5; color:var(--text3);">
            </div>
            <div class="form-group">
                <label class="form-label">–°—É–º–º–∞ (PLN)</label>
                <input type="text" class="form-input" id="invAmount" placeholder="0.00" inputmode="decimal">
            </div>
            <div class="form-group">
                <label class="form-label">–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞</label>
                <input type="text" class="form-input" id="invPurpose" placeholder="Za us≈Çugi...">
            </div>
            <div class="form-row">
                <div class="form-group">
                    <label class="form-label">–û–ø–ª–∞—Ç–∏—Ç—å –¥–æ</label>
                    <input type="date" class="form-input" id="invDueDate">
                </div>
                <div class="form-group">
                    <label class="form-label">–¢–∏–ø –æ–ø–ª–∞—Ç—ã</label>
                    <select class="form-input" id="invPayType">
                        <option value="przelew">–ë–µ–∑–Ω–∞–ª</option>
                        <option value="gotowka">–ù–∞–ª–∏—á–Ω—ã–µ</option>
                        <option value="karta">–ö–∞—Ä—Ç–∞</option>
                    </select>
                </div>
            </div>

            <div class="invoice-actions">
                <button class="btn btn-primary" onclick="invoiceAction('email')">
                    <span class="btn-icon">üìß</span> –í—ã—Å–ª–∞—Ç—å e-mail
                </button>
                <button class="btn btn-green" onclick="invoiceAction('pdf')">
                    <span class="btn-icon">üìÑ</span> –°–æ—Ö—Ä–∞–Ω–∏—Ç—å PDF
                </button>
                <button class="btn btn-outline" onclick="invoiceAction('ksef')">
                    <span class="btn-icon">üèõ</span> –í—ã—Å–ª–∞—Ç—å KSeF
                </button>
            </div>
        </div>
        <div class="back-row">
            <button class="btn btn-secondary" onclick="showScreen('page-dashboard')">
                <span class="btn-icon">‚Üê</span> –í–µ—Ä–Ω—É—Ç—å—Å—è
            </button>
        </div>
    </div>

    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <!-- PAGE INFO: FULL DETAILS                 -->
    <!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
    <div id="page-info" class="screen">
        <div class="card">
            <div class="card-title"><span class="icon">üí∞</span> –§–∏–Ω–∞–Ω—Å–æ–≤–∞—è —Å–≤–æ–¥–∫–∞</div>
            <div class="info-row"><span class="ir-label">–ü—Ä–∏—Ö–æ–¥</span><span class="ir-value" id="infoPrihod">‚Äî</span></div>
            <div class="info-row"><span class="ir-label">–†–∞—Å—Ö–æ–¥</span><span class="ir-value" id="infoRashod">‚Äî</span></div>
            <div class="info-row"><span class="ir-label">–î–æ—Ö–æ–¥</span><span class="ir-value" id="infoDohod">‚Äî</span></div>
            <div class="info-row"><span class="ir-label">–ù–î–° (VAT)</span><span class="ir-value" id="infoVat">‚Äî</span></div>
            <div class="info-row"><span class="ir-label">PIT</span><span class="ir-value" id="infoPit">‚Äî</span></div>
            <div class="info-row"><span class="ir-label">ZUS</span><span class="ir-value" id="infoZus">‚Äî</span></div>
        </div>

        <div class="card">
            <div class="card-title"><span class="icon">üìÑ</span> –î–µ–∫–ª–∞—Ä–∞—Ü–∏–∏</div>
            <div id="infoDeclarations">
                <div class="loading-state"><div class="spinner"></div><p>–ó–∞–≥—Ä—É–∑–∫–∞...</p></div>
            </div>
        </div>

        <div class="card">
            <div class="card-title"><span class="icon">‚öôÔ∏è</span> –¢–∞—Ä–∏—Ñ –∏ –ø–æ–¥–¥–µ—Ä–∂–∫–∞</div>
            <div class="info-row"><span class="ir-label">–¢–∞—Ä–∏—Ñ</span><span class="ir-value" id="infoTariff">‚Äî</span></div>
            <div class="info-row"><span class="ir-label">–°—Ç–æ–∏–º–æ—Å—Ç—å</span><span class="ir-value" id="infoPrice">‚Äî</span></div>
            <div class="info-row"><span class="ir-label">–°–ª–µ–¥—É—é—â–∏–π –ø–ª–∞—Ç—ë–∂</span><span class="ir-value" id="infoNextPay">‚Äî</span></div>
        </div>

        <button class="btn btn-secondary" onclick="showScreen('page-company')" style="margin-bottom:8px;">
            <span class="btn-icon">üè¢</span> –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–∞–Ω–∏–∏
        </button>
        <div class="back-row">
            <button class="btn btn-secondary" onclick="showScreen('page-dashboard')">
                <span class="btn-icon">‚Üê</span> –í–µ—Ä–Ω—É—Ç—å—Å—è
            </button>
        </div>
    </div>

</div>

<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<!-- JAVASCRIPT                                      -->
<!-- ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê -->
<script>
// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ CONFIG ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const N8N_BASE = 'https://your-n8n-url.com/webhook/finansemg'; // ‚Üê –ó–ê–ú–ï–ù–ò
const tg = window.Telegram?.WebApp;
if (tg) { tg.expand(); tg.enableClosingConfirmation(); }
const telegramId = tg?.initDataUnsafe?.user?.id || 'demo_user';

let currentInvoiceType = 'proforma';
let clientData = null;
let isFirstLogin = false;

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ NAVIGATION ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const screenHistory = [];

function showScreen(id) {
    const current = document.querySelector('.screen.active');
    if (current) {
        screenHistory.push(current.id);
        current.classList.remove('active');
    }
    const next = document.getElementById(id);
    next.classList.add('active');

    // Telegram back button
    if (tg) {
        if (id === 'page-login') { tg.BackButton.hide(); }
        else { tg.BackButton.show(); }
    }

    // On screen load actions
    if (id === 'page-dashboard') loadDashboard();
    if (id === 'page-upload') loadRecentDocs();
    if (id === 'page-chat') loadChat();
    if (id === 'page-info') loadFullInfo();
    if (id === 'page-company') {
        document.getElementById('compBackBtn').style.display = isFirstLogin ? 'none' : 'flex';
        if (clientData) fillCompanyForm(clientData);
    }
}

function goBack() {
    if (screenHistory.length > 0) {
        const prev = screenHistory.pop();
        document.querySelector('.screen.active')?.classList.remove('active');
        document.getElementById(prev).classList.add('active');
    }
}

if (tg) {
    tg.BackButton.onClick(() => {
        const active = document.querySelector('.screen.active');
        if (active.id === 'page-dashboard') { tg.close(); }
        else if (active.id === 'page-login') { tg.close(); }
        else { showScreen('page-dashboard'); }
    });
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PAGE 1: CODE INPUT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
const codeDigits = document.querySelectorAll('.code-digit');
codeDigits.forEach((input, idx) => {
    input.addEventListener('input', (e) => {
        const val = e.target.value.replace(/\D/g, '');
        e.target.value = val;
        if (val && idx < 5) codeDigits[idx + 1].focus();
        if (val) e.target.classList.add('filled');
        else e.target.classList.remove('filled');

        // Check if all 6 entered
        const code = Array.from(codeDigits).map(d => d.value).join('');
        if (code.length === 6) verifyCode(code);
    });
    input.addEventListener('keydown', (e) => {
        if (e.key === 'Backspace' && !e.target.value && idx > 0) {
            codeDigits[idx - 1].focus();
            codeDigits[idx - 1].value = '';
            codeDigits[idx - 1].classList.remove('filled');
        }
    });
    input.addEventListener('focus', () => e.target?.select?.());
});

async function verifyCode(code) {
    try {
        // DEMO: accept "123456"
        // PROD: uncomment API call
        /*
        const res = await fetch(`${N8N_BASE}/verify-code`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ telegram_id: telegramId, code: code })
        });
        const data = await res.json();
        if (!data.success) throw new Error('wrong_code');
        clientData = data.client;
        isFirstLogin = !data.client.company_name;
        */

        // DEMO logic
        if (code === '123456') {
            clientData = getDemoClientData();
            isFirstLogin = false;

            if (isFirstLogin) {
                showScreen('page-company');
            } else {
                showScreen('page-dashboard');
            }
            toast('success', '‚úÖ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å!');
        } else {
            throw new Error('wrong_code');
        }
    } catch (err) {
        codeDigits.forEach(d => {
            d.classList.add('error-shake');
            d.value = '';
            d.classList.remove('filled');
            setTimeout(() => d.classList.remove('error-shake'), 500);
        });
        codeDigits[0].focus();
        toast('error', '‚ùå –ù–µ–≤–µ—Ä–Ω—ã–π –∫–æ–¥');
    }
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PAGE 11: FORGOT CODE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function verifyIdentity() {
    const nip = document.getElementById('forgotNip').value.trim();
    const pesel = document.getElementById('forgotPesel').value.trim();

    if (nip.length !== 10) { toast('error', 'NIP –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 10 —Ü–∏—Ñ—Ä'); return; }
    if (pesel.length !== 11) { toast('error', 'PESEL –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 11 —Ü–∏—Ñ—Ä'); return; }

    try {
        // PROD:
        /*
        const res = await fetch(`${N8N_BASE}/verify-identity`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ telegram_id: telegramId, nip, pesel })
        });
        const data = await res.json();
        if (!data.success) throw new Error('not_found');
        */

        // DEMO:
        showScreen('page-newcode');
        toast('success', '‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –ø—Ä–æ–π–¥–µ–Ω–∞');
    } catch {
        toast('error', '‚ùå –î–∞–Ω–Ω—ã–µ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã');
    }
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PAGE 12: SET NEW CODE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function saveNewCode() {
    const code1 = document.getElementById('newCode').value.trim();
    const code2 = document.getElementById('confirmCode').value.trim();

    if (code1.length !== 6) { toast('error', '–ö–æ–¥ –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 6 —Ü–∏—Ñ—Ä'); return; }
    if (code1 !== code2) { toast('error', '–ö–æ–¥—ã –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç'); return; }

    try {
        // PROD:
        /*
        await fetch(`${N8N_BASE}/set-code`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ telegram_id: telegramId, new_code: code1 })
        });
        */

        toast('success', '‚úÖ –ö–æ–¥ –∏–∑–º–µ–Ω—ë–Ω!');
        setTimeout(() => showScreen('page-login'), 1000);
    } catch {
        toast('error', '‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
    }
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PAGE 2: COMPANY DATA ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
// Auto-detect IBAN prefix for SWIFT visibility
document.getElementById('compIban')?.addEventListener('input', (e) => {
    const val = e.target.value.replace(/\s/g, '').toUpperCase();
    const hasPrefix = /^[A-Z]{2}/.test(val);
    const isPL = val.startsWith('PL');
    document.getElementById('swiftGroup').style.display = (hasPrefix && !isPL) ? 'block' : 'none';
});

function fillCompanyForm(data) {
    if (!data) return;
    document.getElementById('compName').value = data.company_name || '';
    document.getElementById('compStreet').value = data.street || '';
    document.getElementById('compBuilding').value = data.building || '';
    document.getElementById('compZip').value = data.zip || '';
    document.getElementById('compCity').value = data.city || '';
    document.getElementById('compCountry').value = data.country || 'PL';
    document.getElementById('compNip').value = data.nip || '';
    document.getElementById('compIban').value = data.iban || '';
    document.getElementById('compSwift').value = data.swift || '';
    document.getElementById('compPkd').value = data.pkd || '';
}

async function saveCompanyData() {
    const data = {
        telegram_id: telegramId,
        company_name: document.getElementById('compName').value.trim(),
        street: document.getElementById('compStreet').value.trim(),
        building: document.getElementById('compBuilding').value.trim(),
        zip: document.getElementById('compZip').value.trim(),
        city: document.getElementById('compCity').value.trim(),
        country: document.getElementById('compCountry').value,
        nip: document.getElementById('compNip').value.trim(),
        iban: document.getElementById('compIban').value.trim(),
        swift: document.getElementById('compSwift').value.trim(),
        pkd: document.getElementById('compPkd').value.trim(),
    };

    if (!data.company_name) { toast('error', '–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏'); return; }
    if (!data.nip || data.nip.length !== 10) { toast('error', 'NIP –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å 10 —Ü–∏—Ñ—Ä'); return; }

    try {
        // PROD:
        /*
        await fetch(`${N8N_BASE}/save-company`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data)
        });
        */

        clientData = { ...clientData, ...data };
        toast('success', '‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!');
        
        if (isFirstLogin) {
            isFirstLogin = false;
            setTimeout(() => showScreen('page-dashboard'), 800);
        }
    } catch {
        toast('error', '‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è');
    }
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PAGE 3: DASHBOARD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function loadDashboard() {
    try {
        // PROD:
        /*
        const res = await fetch(`${N8N_BASE}/get-dashboard`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ telegram_id: telegramId })
        });
        const d = await res.json();
        */

        // DEMO:
        const d = {
            prihod: '12 450',
            rashod: '3 280',
            dohod: '9 170',
            vat: '1 420',
            pit: '815',
            zus: '1 620'
        };

        document.getElementById('dPrihod').textContent = d.prihod + ' z≈Ç';
        document.getElementById('dRashod').textContent = d.rashod + ' z≈Ç';
        document.getElementById('dDohod').textContent = d.dohod + ' z≈Ç';
        document.getElementById('dVat').textContent = d.vat + ' z≈Ç';
        document.getElementById('dPit').textContent = d.pit + ' z≈Ç';
        document.getElementById('dZus').textContent = d.zus + ' z≈Ç';
    } catch {
        toast('error', '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö');
    }
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PAGE 4: UPLOAD ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
['fileGallery', 'fileCamera', 'fileFiles'].forEach(id => {
    document.getElementById(id)?.addEventListener('change', handleFileUpload);
});

async function handleFileUpload(e) {
    const files = e.target.files;
    if (!files.length) return;
    const status = document.getElementById('uploadStatus');
    status.innerHTML = '<div style="padding:12px; background:var(--brand-light); border-radius:8px; color:var(--brand); font-size:14px; text-align:center;">üì§ –ó–∞–≥—Ä—É–∂–∞–µ–º...</div>';

    try {
        for (let file of files) {
            const formData = new FormData();
            formData.append('file', file);
            formData.append('telegram_id', telegramId);
            formData.append('filename', file.name);

            // DEMO:
            await new Promise(r => setTimeout(r, 800));

            // PROD:
            /*
            await fetch(`${N8N_BASE}/upload`, { method: 'POST', body: formData });
            */
        }
        status.innerHTML = '<div style="padding:12px; background:var(--green-bg); border-radius:8px; color:var(--green); font-size:14px; text-align:center;">‚úÖ –î–æ–∫—É–º–µ–Ω—Ç—ã –∑–∞–≥—Ä—É–∂–µ–Ω—ã!</div>';
        setTimeout(() => { status.innerHTML = ''; loadRecentDocs(); }, 2500);
    } catch {
        status.innerHTML = '<div style="padding:12px; background:var(--red-bg); border-radius:8px; color:var(--red); font-size:14px; text-align:center;">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>';
    }
    e.target.value = '';
}

async function loadRecentDocs() {
    // DEMO:
    const docs = [
        { name: 'Faktura FV/12/02/2026.pdf', date: '08.02.2026', icon: 'üìÑ' },
        { name: 'Paragon Allegro.jpg', date: '06.02.2026', icon: 'üì∑' },
        { name: 'Umowa najmu.pdf', date: '01.02.2026', icon: 'üìÑ' },
    ];

    // PROD:
    /*
    const res = await fetch(`${N8N_BASE}/get-docs`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ telegram_id: telegramId })
    });
    const docs = await res.json();
    */

    document.getElementById('recentDocs').innerHTML = docs.map(d => `
        <div class="doc-item">
            <span class="di-icon">${d.icon}</span>
            <div>
                <div class="di-name">${d.name}</div>
                <div class="di-date">${d.date}</div>
            </div>
        </div>
    `).join('') || '<p style="color:var(--text3); text-align:center; padding:20px;">–ù–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤</p>';
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PAGE 5: CHAT ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function loadChat() {
    // DEMO:
    const msgs = [
        { from: 'client', text: '–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ! –ö–æ–≥–¥–∞ –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞ –¥–µ–∫–ª–∞—Ä–∞—Ü–∏—è –∑–∞ —è–Ω–≤–∞—Ä—å?', time: '14:30' },
        { from: 'manager', text: '–î–æ–±—Ä—ã–π –¥–µ–Ω—å! –î–µ–∫–ª–∞—Ä–∞—Ü–∏—è –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞ —Å–µ–≥–æ–¥–Ω—è –¥–æ 18:00.', time: '14:45' },
        { from: 'client', text: '–û—Ç–ª–∏—á–Ω–æ, —Å–ø–∞—Å–∏–±–æ!', time: '14:46' },
    ];

    // PROD:
    /*
    const res = await fetch(`${N8N_BASE}/get-messages`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ telegram_id: telegramId })
    });
    const msgs = await res.json();
    */

    const box = document.getElementById('chatMessages');
    box.innerHTML = msgs.map(m => `
        <div class="msg ${m.from}">
            <div class="msg-sender">${m.from === 'client' ? '–í—ã' : '–ú–µ–Ω–µ–¥–∂–µ—Ä'}</div>
            <div>${m.text}</div>
            <div class="msg-time">${m.time}</div>
        </div>
    `).join('');
    box.scrollTop = box.scrollHeight;
}

async function sendChatMessage() {
    const input = document.getElementById('chatInput');
    const text = input.value.trim();
    if (!text) return;

    appendMessage('client', text);
    input.value = '';

    // PROD:
    /*
    await fetch(`${N8N_BASE}/send-message`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ telegram_id: telegramId, message: text })
    });
    */

    // DEMO auto-reply
    setTimeout(() => {
        appendMessage('manager', '–°–ø–∞—Å–∏–±–æ –∑–∞ —Å–æ–æ–±—â–µ–Ω–∏–µ! –ú–µ–Ω–µ–¥–∂–µ—Ä –æ—Ç–≤–µ—Ç–∏—Ç –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è.');
    }, 1500);
}

function appendMessage(from, text) {
    const box = document.getElementById('chatMessages');
    const time = new Date().toLocaleTimeString('ru-RU', { hour: '2-digit', minute: '2-digit' });
    box.insertAdjacentHTML('beforeend', `
        <div class="msg ${from}">
            <div class="msg-sender">${from === 'client' ? '–í—ã' : '–ú–µ–Ω–µ–¥–∂–µ—Ä'}</div>
            <div>${text}</div>
            <div class="msg-time">${time}</div>
        </div>
    `);
    box.scrollTop = box.scrollHeight;
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PAGE 6: INVOICE ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function setInvoiceType(type, btn) {
    currentInvoiceType = type;
    document.querySelectorAll('.toggle-opt').forEach(b => b.classList.remove('active'));
    btn.classList.add('active');
}

async function lookupNip() {
    const nip = document.getElementById('invNip').value.trim();
    if (nip.length !== 10) { toast('error', '–í–≤–µ–¥–∏—Ç–µ 10 —Ü–∏—Ñ—Ä NIP'); return; }

    try {
        toast('success', 'üîç –ü–æ–∏—Å–∫ –ø–æ NIP...');
        
        // PROD: call GUS/CEIDG via n8n
        /*
        const res = await fetch(`${N8N_BASE}/lookup-nip`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ nip })
        });
        const data = await res.json();
        document.getElementById('invContractor').value = data.name || '';
        */

        // DEMO:
        setTimeout(() => {
            document.getElementById('invContractor').value = 'DEMO Sp. z o.o.';
            toast('success', '‚úÖ –ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç –Ω–∞–π–¥–µ–Ω');
        }, 1000);
    } catch {
        toast('error', '‚ùå –ö–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω');
    }
}

async function invoiceAction(action) {
    const invoiceData = {
        telegram_id: telegramId,
        type: currentInvoiceType,
        contractor: document.getElementById('invContractor').value.trim(),
        contractor_nip: document.getElementById('invNip').value.trim(),
        amount: document.getElementById('invAmount').value.trim(),
        purpose: document.getElementById('invPurpose').value.trim(),
        due_date: document.getElementById('invDueDate').value,
        pay_type: document.getElementById('invPayType').value,
        action: action // 'email', 'pdf', 'ksef'
    };

    if (!invoiceData.contractor) { toast('error', '–í–≤–µ–¥–∏—Ç–µ –∫–æ–Ω—Ç—Ä–∞–≥–µ–Ω—Ç–∞'); return; }
    if (!invoiceData.amount) { toast('error', '–í–≤–µ–¥–∏—Ç–µ —Å—É–º–º—É'); return; }

    try {
        toast('success', '‚è≥ –§–æ—Ä–º–∏—Ä—É–µ–º –¥–æ–∫—É–º–µ–Ω—Ç...');

        // PROD:
        /*
        const res = await fetch(`${N8N_BASE}/create-invoice`, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(invoiceData)
        });
        const result = await res.json();
        
        if (action === 'pdf' && result.pdf_url) {
            window.open(result.pdf_url, '_blank');
        }
        */

        // DEMO:
        setTimeout(() => {
            if (action === 'email') toast('success', '‚úÖ –°—á—ë—Ç –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –Ω–∞ email');
            else if (action === 'pdf') toast('success', '‚úÖ PDF —Å–æ—Ö—Ä–∞–Ω—ë–Ω');
            else if (action === 'ksef') toast('success', 'üèõ KSeF ‚Äî —Ñ—É–Ω–∫—Ü–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ');
        }, 1500);
    } catch {
        toast('error', '‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞');
    }
}

// Set default due date = +14 days
document.getElementById('invDueDate').value = new Date(Date.now() + 14 * 86400000).toISOString().split('T')[0];

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ PAGE INFO ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
async function loadFullInfo() {
    // PROD:
    /*
    const res = await fetch(`${N8N_BASE}/get-full-info`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ telegram_id: telegramId })
    });
    const d = await res.json();
    */

    // DEMO:
    const d = {
        prihod: '12 450 z≈Ç', rashod: '3 280 z≈Ç', dohod: '9 170 z≈Ç',
        vat: '1 420 z≈Ç', pit: '815 z≈Ç', zus: '1 620 z≈Ç',
        tariff: 'STANDARD', price: '499 z≈Ç/–º–µ—Å', next_pay: '25.02.2026',
        declarations: [
            { month: '–Ø–Ω–≤–∞—Ä—å 2026', status: 'sent' },
            { month: '–§–µ–≤—Ä–∞–ª—å 2026', status: 'pending' },
        ]
    };

    document.getElementById('infoPrihod').textContent = d.prihod;
    document.getElementById('infoRashod').textContent = d.rashod;
    document.getElementById('infoDohod').textContent = d.dohod;
    document.getElementById('infoVat').textContent = d.vat;
    document.getElementById('infoPit').textContent = d.pit;
    document.getElementById('infoZus').textContent = d.zus;
    document.getElementById('infoTariff').textContent = d.tariff;
    document.getElementById('infoPrice').textContent = d.price;
    document.getElementById('infoNextPay').textContent = d.next_pay;

    document.getElementById('infoDeclarations').innerHTML = d.declarations.map(dec => `
        <div class="info-row">
            <span class="ir-label">${dec.month}</span>
            <span style="font-size:13px; font-weight:500; color:${dec.status === 'sent' ? 'var(--green)' : 'var(--orange)'};">
                ${dec.status === 'sent' ? '‚úÖ –û—Ç–ø—Ä–∞–≤–ª–µ–Ω–∞' : '‚è≥ –í —Ä–∞–±–æ—Ç–µ'}
            </span>
        </div>
    `).join('');
}

// ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ HELPERS ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ
function toast(type, msg) {
    document.querySelectorAll('.alert-toast').forEach(t => t.remove());
    const el = document.createElement('div');
    el.className = `alert-toast ${type}`;
    el.textContent = msg;
    document.body.appendChild(el);
    setTimeout(() => el.remove(), 3000);
}

function getDemoClientData() {
    return {
        company_name: 'DEMO Sp. z o.o.',
        street: 'ul. Przyk≈Çadowa',
        building: '10/2',
        zip: '00-001',
        city: 'Warszawa',
        country: 'PL',
        nip: '1234567890',
        iban: 'PL12345678901234567890123456',
        swift: '',
        pkd: '62.01.Z'
    };
}

// Focus first code input on load
setTimeout(() => codeDigits[0]?.focus(), 300);
</script>
</body>
</html>
